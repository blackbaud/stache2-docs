<stache
  navTitle="New Stache"
  navOrder="1"
  layout="container">

  <stache-tutorial>
    <stache-tutorial-heading>
        Create a {{ stache.jsonData.global.productNameLong }} Documentation Site
    </stache-tutorial-heading>
    <stache-tutorial-summary>
      <p>
        This tutorial provides step-by-step instructions on how to create a new SKY UX single-page application (SPA) with the {{ stache.jsonData.global.productNameLong }} component library. Internal Blackbaud users will also be set up with a new VSTS Git repo. Internal users who require GitHub should contact us before continuing.
      </p>
    </stache-tutorial-summary>

    <sky-alert alertType="info">Before you begin this tutorial, you need to complete the <a routerLink="/learn/get-started">SKY UX prerequisites</a>. </sky-alert>

    <stache-tutorial-step>
      <stache-tutorial-step-heading>
        Create and provision your SKY UX application in the App Management Portal
      </stache-tutorial-step-heading>
      <stache-tutorial-step-body>
        <p>
          For internal Blackbaud users only, we'll create your SKY UX application and repo with the SKY UX App Management Portal. This creates a Visual Studio Team Services (VSTS) repo for the application and also creates VSTS build and release definitions.
        </p>
        <p>
          If you are not an internal Blackbaud user, skip to step 2.
        </p>
        <ol>
          <li>
            <p>
              Navigate to the <a href="https://host.nxt.blackbaud.com/skyux-apps/">SKY UX App Management Portal</a>.
            </p>
          </li>
          <li>
            <p>
              Enter a name for your {{ stache.jsonData.global.productNameShort }} site. We request that you append any documentation sites with <stache-code>-docs</stache-code>. For example: <stache-code>engineering-system-docs</stache-code>.
            </p>
            <p>
              The name you enter here will become part of your site's URL.
            </p>
          </li>
          <li>
            <p>
              Review and approve the terms and conditions.
            </p>
          </li>
          <li>
            <p>
              Select <strong>Create Your Application</strong>. This process may take a moment.
            </p>
          </li>
          <li>
            When the application is created, a ready page appears. We recommend you save a copy of this page.
          </li>
          <li>
            Copy the Git Repo URL.
          </li>
        </ol>
      </stache-tutorial-step-body>
    </stache-tutorial-step>
    <stache-tutorial-step>
      <stache-tutorial-step-heading>
        Clone your repo and set up your {{ stache.jsonData.global.productNameShort }} site
      </stache-tutorial-step-heading>
      <stache-tutorial-step-body>
        <ol>
          <li>
            <p>
              Navigate to the folder with your VSTS and/or GitHub repos, or the location you want to save your new repo.
            </p>
            <stache-include fileName="folder-warning.html">
            </stache-include>
          </li>
          <li>
            <p>
              Open command prompt (Windows) or Terminal (Mac) and in the command line, enter <stache-code>skyux new --template stache</stache-code>. Press <kbd>Enter</kbd> (Windows) or <kbd>return</kbd> (Mac).
            </p>
            <sky-alert alertType="danger">
              For Windows users, do not use Git Bash. There's a known timeout issue when you run <stache-code>skyux new</stache-code>. The install may not complete. Use the Windows command prompt only.
            </sky-alert>
          </li>
          <li>
            <p>
              For internal Blackbaud users, in the first prompt, enter the name you provided in the SKY UX App Management Portal. For example <stache-code>engineering-system-docs</stache-code>. The SKY UX CLI creates a folder with this name and prefixes it with "skyux-spa."
            </p>
            <p>For non-Blackbaud users, enter the name of your SPA.</p>
          </li>
          <li>
            <p>
              In the second prompt, if you are an internal Blackbaud user, paste in the URL to your repo that we copied in step 1.6.
            </p>
            <p>For non-Blackbaud users, enter the location of your repo.</p>
          </li>
          <p>
            Your repo is now being cloned and set up locally. This will take a few minutes.
          </p>
        </ol>
      </stache-tutorial-step-body>
    </stache-tutorial-step>

    <stache-tutorial-step>
      <stache-tutorial-step-heading>
        Verify authentication for your application
      </stache-tutorial-step-heading>
      <stache-tutorial-step-body>
        <p>
          After you create your application, it is potentially available on the public Internet. Be careful to not allow anonymous users access to protected assets, such as user data or internal systems.
        </p>
        <p>
          We default to Blackbaud Identity Service turned on, but we recommend your first step be to verify it.
        </p>
        <sky-alert alertType="warning">If you're a non-Blackbaud user, you need to turn the Blackbaud Identity Service off.</sky-alert>
        <ol>
          <li>
            <p>
              Navigate to the repo on your local machine.
            </p>
          </li>
          <li>
            <p>
              Open <stache-code>skyuxconfig.json</stache-code> file in your preferred text editor.
            </p>
          </li>
          <li>
            <p>
              Find <stache-code>"auth": true</stache-code> as seen below. If you are a Blackbaud user, double-check that the config setting is <strong>true</strong>. If you're a non-Blackbaud user, change the setting to <strong>false</strong>.
            </p>
          </li>
        </ol>
        <stache-include fileName="skyux-config-sample.html"></stache-include>
      </stache-tutorial-step-body>
    </stache-tutorial-step>
    <stache-tutorial-step>
      <stache-tutorial-step-heading>
        Serve your {{ stache.jsonData.global.productNameShort }} application
      </stache-tutorial-step-heading>
      <stache-tutorial-step-body>
        <p>
          To serve your site locally, from the command line, enter <stache-code>skyux serve</stache-code>. A new browser window opens to your documentation site.
        </p>
      <sky-alert alertType="info">For internal Blackbaud users, the URL in your browser is the same as your production URL. The red bar at the top of the page indicates when you are in "dev mode." To see your production site, select the red bar and then select <strong>delete</strong> next to <strong>Custom Config</strong>. To return to dev mode, stop serving in your command prompt and serve again.
      </sky-alert>
      </stache-tutorial-step-body>
    </stache-tutorial-step>

    <stache-tutorial-step>
      <stache-tutorial-step-heading>
        Push your initial commit
      </stache-tutorial-step-heading>
      <stache-tutorial-step-body>
        <p>
        When you run <stache-code>skyux new --template stache</stache-code> to create your local SPA, the SKY UX CLI creates an <stache-code>initial commit</stache-code> branch and adds a variety of files and folders from the Stache template. These template files implement default settings and general best practices for your site.
        </p>
        <p>Let's walk through how to add, commit, push, and merge this branch to <stache-code>master</stache-code>.</p>
        <ol>
          <li>
            From command prompt or Terminal within your project, enter <stache-code>git add --all</stache-code>.
          </li>
          <li>
            Then, enter <stache-code>git commit -m "initial commit"</stache-code>.
          </li>
          <li>
            Enter <stache-code>git push origin initial-commit</stache-code>.
          </li>
          <li>
            Navigate to your repo. For most Blackbaud users, your repo is in <a href="https://blackbaud.visualstudio.com/Products/_git/">VSTS Git website</a>.
          </li>
          <li>
            Create a pull request into the <stache-code>master</stache-code> branch.
            <ul>
              <li>For VSTS repos, you can do this from Files page with the link VSTS provides when you push up a new branch, or from the Pull Requests page.</li>
              <li>For GitHub repos, you can create the pull request from the <strong>Code</strong> or <strong>Pull Requests</strong> tabs.</li>
            </ul>
          </li>
          <li>
            For internal Blackbaud VSTS repos, a build will kick off to test your changes when you make the pull request. Upon successful completion, a preview link is added to the comments of your PR. You can share this preview link with others so they can see how your changes will appear. This preview link does not affect your live production site.
          </li>
          <li>
            <p>
              For internal Blackbaud VSTS repos, select the Complete button after meeting the requirements for merging to <stache-code>master</stache-code>. (Merging requires 1 peer review and a successful build.)
            </p>
            <p>For GitHub repos, depending on your repo settings, select <strong>Merge pull request</strong> or <strong>Squash and merge</strong>.</p>
            <sky-alert alertType="info">For Blackbaud users with VSTS repos, the merge kicks off another build that updates your live production site. After you get the email that the build succeeded, navigate to your SPA's production URL. The URL will be <stache-code>https://docs.blackbaud.com/(repo name minus skyux-spa)</stache-code>. For example, https://docs.blackbaud.com/engineering-system-docs/.</sky-alert>
          </li>

        </ol>
      </stache-tutorial-step-body>
    </stache-tutorial-step>

    <stache-tutorial-step>
      <stache-tutorial-step-heading>
        Next steps
      </stache-tutorial-step-heading>
      <stache-tutorial-step-body>
        <p>
          You are now ready to create stellar technical documentation. To continue the learning, we recommend you review:
        </p>
        <ul>
          <li>
            <p>
              <a routerLink="/learn/basics">{{ stache.jsonData.global.productNameShort }} basics</a>
            </p>
          </li>
          <li>
            <p>
              <a routerLink="/learn/update-stache">How to update {{ stache.jsonData.global.productNameShort }}</a>
            </p>
          </li>
          <li>
            <p>
              <a routerLink="/content/">Learn about the cool things you can do with Stache</a>
            </p>
          </li>
        </ul>
      </stache-tutorial-step-body>
    </stache-tutorial-step>
  </stache-tutorial>
</stache>
